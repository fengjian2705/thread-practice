# 线程同步机制（重要）

> 基本概念

* 当多个线程同时访问同一种共享资源时，可能会造成数据的覆盖等不一致性问题，此时就需要对
  线程之间进行通信和协调，该机制就叫做线程的同步机制
* 多个线程并发读同一个临街资源时会发生线程并发安全问题
* 异步操作：多线程并发的操作，各自独立运行
* 同步操作：多线程串行的操作，先后执行的顺序

> 解决方案

* 由程序结果可知：当两个线程同时对同一个账户进行取款时，导致最终的账户余额不合理
* 引发原因：线程一执行取款时还没来得及将取款后的余额写进后天，线程二就已经开始取款
* 解决方案：让线程一执行完毕取款操作后，再让线程二执行即可，将线程的并发操作改为串行操作
* 经验分享：在以后的开发尽量减少串行操作的范围，从而提高效率

> 实现方式

* 在 java 语言中使用 synchronized 关键字来实现同步/对象锁机制从而保证线程执行的原子性，具体
  方式如下：
  * 使用同步代码块的方式实现部分代码的锁定，格式如下:
      ```java
        synchronized(类类型的引用){
          编写所有需要锁定的代码;
      }
      ```
  * 使用同步方法的方式实现所有代码的锁定
    * 直接使用**synchronized**关键字来修饰整个方法即可
    * 该方式等价于：
    ```java
      synchronized(this){整个方法体的代码}
    ```
    
> 静态方法的锁定

* 当我们对一个静态方法加锁，如：
  ```java
    public synchronized static void xxx(){....}
  ```
* 那么该方法锁定的是类对象，每个类都有唯一的一个类对象，获取类对象的方式：类名.class
